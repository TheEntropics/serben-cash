<% @notifications.each do |notification| %>
  <div class="panel panel-primary panel-<%= notification.importance %>">
    <div class="panel-body">
      <%= notification.text %>
    </div>
  </div>
<% end %>

<table class="table">
  <thead>
    <tr>
      <th>User</th>
      <% @months.each do |month| %>
        <th><%= month.name %></th>
      <% end %>
      <% if current_user %>
        <th>Actions</th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @grid.each do |user, cols| %>
      <tr class="<%= 'banned' if user.banned %> <%= 'deleted' if user.deleted %>">
        <td>
          <%= user.name %>
          <small><%= user.username %></small>
          <% user.roles.each do |role| %>
            <span class="label label-default"><%= role.name %></span>
          <% end %>
        </td>
        <% @months.each do |month| %>
          <% if cols[month] == nil %>
            <td><%= false_mark %></td>
          <% else %>
            <td><%= true_mark %></td>
          <% end %>
        <% end %>
        <% if current_user %>
          <td><%= link_to 'Edit', edit_user_path(user), class: ['btn', 'btn-warning', 'btn-xs'] %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<h2>This month <small><%= @current_month.name %></small></h2>
<div class="progress">
  <div class="progress-bar" style="width: <%= 100.0*@current_month_paid/@total_per_month %>%;">
    <%= number_to_currency @current_month_paid, unit: '€ ' %> / <%= number_to_currency @total_per_month, unit: '€ ' %>
  </div>
</div>

<h2>Balance</h2>
<table class="table">
  <thead>
    <tr>
      <th>Date</th>
      <th>Details</th>
      <th>Amount</th>
    </tr>
  </thead>
  <tbody>
    <% @events.each do |event| %>
      <tr>
        <td><%= format_date event.date %></td>
        <td><%= event.description %></td>
        <td><%= number_to_currency(event.amount, unit: '€ ') %></td>
      </tr>
    <% end %>
  </tbody>
</table>
